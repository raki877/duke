<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hill Climb Racing - Perfect Clone 2025</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
    * { margin:0; padding:0; overflow:hidden; }
    body { background:#000; display:flex; justify-content:center; align-items:center; height:100vh; image-rendering:pixelated; }
    canvas { image-rendering:pixelated; }
    .ui { position:absolute; top:15px; left:15px; color:white; font: bold 20px Arial; text-shadow: 2px 2px 4px #000; }
    .mobile { position:absolute; bottom:0; width:100%; display:flex; justify-content:space-between; padding:20px; box-sizing:border-box; pointer-events:none; }
    .btn { width:90px; height:90px; background:rgba(255,255,255,0.15); border:4px solid white; border-radius:50%; color:white; font-size:40px; display:flex; align-items:center; justify-content:center; user-select:none; pointer-events:all; }
    .btn:active { background:rgba(255,255,255,0.4); }
    #gameOver { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.95); padding:40px 60px; border-radius:20px; text-align:center; color:white; font-family:Arial; display:none; border:5px solid #ff0040; }
    #gameOver h1 { font-size:50px; color:#ff0040; margin-bottom:20px; }
    #restart { margin-top:30px; padding:15px 50px; font-size:24px; background:#00d026; border:none; border-radius:12px; color:white; cursor:pointer; }
</style>
</head>
<body>

<canvas id="c"></canvas>

<div class="ui">
    <div>Distance: <span id="dist">0</span>m</div>
    <div style="margin-top:8px">Fuel: <span id="fuel">100</span>%</div>
    <div style="margin-top:8px">Coins: <span id="coins">0</span></div>
</div>

<div class="mobile">
    <div style="display:flex; gap:30px">
        <div class="btn" id="left">◄</div>
        <div class="btn" id="up">↑</div>
    </div>
    <div style="display:flex; gap:30px">
        <div class="btn" id="down">↓</div>
        <div class="btn" id="right">►</div>
    </div>
</div>

<div id="gameOver">
    <h1>CRASHED!</h1>
    <h2 id="finalDist">0 m</h2>
    <h3 id="finalCoins">0 coins collected</h3>
    <button id="restart">PLAY AGAIN</button>
</div>

<script>
// ================ HILL CLIMB RACING - PERFECT 2025 CLONE ================

const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
canvas.width = 1280;
canvas.height = 720;

let cameraX = 0;
let distance = 0;
let coins = 0;
let fuel = 200;

// ================ VEHICLE (Exact Hill Climb Jeep) ================
const car = {
    x: 300, y: 0,
    vx: 0, vy: 0,
    angle: 0,
    wheelBase: 86,
    wheelRadius: 24,
    suspension: 38,
    power: 0.55,
    brakePower: 0.7,
    flipTorque: 0.008,
    wheels: { rear: {}, front: {} }
};

// ================ TERRAIN ================
const terrain = [];
const segment = 40;
let generatedX = 0;

function generateTerrain() {
    while (generatedX < cameraX + canvas.width + 800) {
        let lastY = terrain.length ? terrain[terrain.length-1].y : 450;
        let change = (Math.random()-0.5) * 90;
        if (distance > 1000) change *= 1.3;
        if (distance > 2500) change *= 1.4;
        lastY += change;
        lastY = Math.max(200, Math.min(620, lastY));

        terrain.push({x: generatedX, y: lastY});

        // Coins
        if (Math.random() < 0.25) {
            coinList.push({
                x: generatedX + 20,
                y: lastY - 90 - Math.random()*60,
                collected: false
            });
        }

        generatedX += segment;
    }
}

const coinList = [];

// ================ CONTROLS ================
const keys = { gas:false, brake:false, leanF:false, leanB:false };

document.addEventListener('keydown', e => {
    if('ArrowRight'.includes(e.key)) keys.gas = true;
    if('ArrowLeft'.includes(e.key)) keys.brake = true;
    if('ArrowUp'.includes(e.key)) keys.leanB = true;
    if('ArrowDown'.includes(e.key)) keys.leanF = true;
    if(e.key===' ') { restartGame(); }
});
document.addEventListener('keyup', e => {
    if('ArrowRight'.includes(e.key)) keys.gas = false;
    if('ArrowLeft'.includes(e.key)) keys.brake = false;
    if('ArrowUp'.includes(e.key)) keys.leanB = false;
    if('ArrowDown'.includes(e.key)) keys.leanF = false;
});

document.getElementById('right').ontouchstart = e=>{e.preventDefault();keys.gas=true};
document.getElementById('right').ontouchend   = e=>{e.preventDefault();keys.gas=false};
document.getElementById('left').ontouchstart  = e=>{e.preventDefault();keys.brake=true};
document.getElementById('left').ontouchend    = e=>{e.preventDefault();keys.brake=false};
document.getElementById('up').ontouchstart    = e=>{e.preventDefault();keys.leanB=true};
document.getElementById('up').ontouchend      = e=>{e.preventDefault();keys.leanB=false};
document.getElementById('down').ontouchstart  = e=>{e.preventDefault();keys.leanF=true};
document.getElementById('down').ontouchend    = e=>{e.preventDefault();keys.leanF=false};

// ================ PHYSICS & UPDATE ================
function getHeight(x) {
    for(let i=1; i<terrain.length; i++){
        if(x < terrain[i].x) {
            let a = terrain[i-1], b = terrain[i];
            let t = (x - a.x)/(b.x - a.x);
            return a.y + t*(b.y - a.y);
        }
    }
    return 450;
}

function updateCar() {
    if(fuel <= 0 && car.vx < 0.1) keys.gas = false;

    // Wheel positions
    let rearX = car.x - Math.cos(car.angle) * car.wheelBase/2;
    let rearY = car.y - Math.sin(car.angle) * car.wheelBase/2;
    let frontX = car.x + Math.cos(car.angle) * car.wheelBase/2;
    let frontY = car.y + Math.sin(car.angle) * car.wheelBase/2;

    let rearGround = getHeight(rearX);
    let frontGround = getHeight(frontX);

    let rearOnGround = rearY + car.suspension > rearGround;
    let frontOnGround = frontY + car.suspension > frontGround;

    // Gravity
    car.vy += 0.6;

    // Engine
    if(keys.gas && fuel > 0) {
        let drive = car.power;
        if(rearOnGround) car.vx += Math.cos(car.angle) * drive;
        car.vy += Math.sin(car.angle) * drive * 0.5;
        fuel -= 0.15;
    }

    // Brake / Reverse
    if(keys.brake) {
        car.vx *= car.brakePower;
        if(rearOnGround && car.vx > 0) car.vx -= 0.4;
    }

    // Leaning (exact same feel as original)
    if(keys.leanF) car.angle += car.flipTorque;
    if(keys.leanB) car.angle -= car.flipTorque;

    // Suspension push
    if(rearOnGround) {
        let compress = (rearY + car.suspension) - rearGround;
        car.vy -= compress * 0.38;
        car.angle += compress * 0.0018;
    }
    if(frontOnGround) {
        let compress = (frontY + car.suspension) - frontGround;
        car.vy -= compress * 0.38;
        car.angle -= compress * 0.0018;
    }

    // Apply velocity
    car.x += car.vx;
    car.y += car.vy;
    car.vx *= 0.985;
    car.vy *= 0.999;
    car.angle *= 0.96;

    // Camera follow
    cameraX += (car.x - canvas.width/2.5 - cameraX) * 0.08;

    // Distance & coins
    distance = Math.floor((car.x - 300)/10);
    document.getElementById('dist').textContent = distance;
    document.getElementById('fuel').textContent = Math.floor(fuel);
    document.getElementById('coins').textContent = coins;

    // Collect coins
    coinList.forEach(c=>{
        if(!c.collected && Math.hypot(c.x - car.x, c.y - car.y) < 60) {
            c.collected = true;
            coins++;
            fuel = Math.min(200, fuel + 25);
        }
    });

    // Game Over (exact same conditions as original)
    if(car.y > getHeight(car.x) + 150 || Math.abs(car.angle) > 2.3) {
        gameOver();
    }
}

// ================ RENDERING (Exact Hill Climb Style) ================
function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Sky gradient
    let grad = ctx.createLinearGradient(0,0,0,canvas.height);
    grad.addColorStop(0, '#87CEEB');
    grad.addColorStop(1, '#E0F6FF');
    ctx.fillStyle = grad;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Sun
    ctx.fillStyle = '#FFF59D';
    ctx.beginPath(); ctx.arc(200 - cameraX*0.05, 100, 80, 0, Math.PI*2); ctx.fill();

    // Mountains (parallax)
    ctx.fillStyle = '#5D4037';
    ctx.beginPath();
    ctx.moveTo(0,720);
    for(let x=0; x<canvas.width+400; x+=120){
        let h = 300 + Math.sin((x + cameraX*0.1)*0.008)*100;
        ctx.lineTo(x, h);
    }
    ctx.lineTo(canvas.width,720);
    ctx.closePath();
    ctx.fill();

    // Terrain
    ctx.fillStyle = '#8B4513';
    ctx.beginPath();
    ctx.moveTo(terrain[0].x - cameraX, 720);
    terrain.forEach(p => ctx.lineTo(p.x - cameraX, p.y));
    ctx.lineTo(generatedX - cameraX, 720);
    ctx.closePath();
    ctx.fill();

    // Grass
    ctx.strokeStyle = '#228B22';
    ctx.lineWidth = 16;
    ctx.beginPath();
    terrain.forEach(p => ctx.lineTo(p.x - cameraX, p.y-8));
    ctx.stroke();

    // Coins
    ctx.font = 'bold 36px Arial';
    coinList.forEach(c=>{
        if(c.collected) return;
        let sx = c.x - cameraX;
        if(sx > -100 && sx < canvas.width+100){
            let bob = Math.sin(Date.now()/150 + c.x)*8;
            ctx.shadowBlur = 20;
            ctx.shadowColor = '#FF0';
            ctx.fillStyle = '#FFD700';
            ctx.fillText('⛀', sx-20, c.y + bob);
            ctx.shadowBlur = 0;
        }
    });

    // === CAR (EXACT HILL CLIMB JEEP) ===
    ctx.save();
    ctx.translate(car.x - cameraX, car.y);
    ctx.rotate(car.angle);

    // Body (iconic green jeep)
    ctx.fillStyle = '#2E7D32';
    ctx.fillRect(-52, -54, 104, 48);           // main body
    ctx.fillStyle = '#1B5E20';
    ctx.fillRect(-38, -78, 76, 34);            // roof

    // Windows
    ctx.fillStyle = '#BBDEFB';
    ctx.fillRect(-32, -72, 24, 22);
    ctx.fillRect(10, -72, 24, 22);

    // Headlights
    ctx.fillStyle = '#FFFF8D';
    ctx.beginPath(); ctx.arc(50, -18, 10, 0, Math.PI*2); ctx.fill();

    // Wheels
    ctx.fillStyle = '#212121';
    ctx.beginPath(); ctx.arc(-38, 0, car.wheelRadius, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc( 38, 0, car.wheelRadius, 0, Math.PI*2); ctx.fill();

    // Wheel hubs
    ctx.fillStyle = '#B0BEC5';
    ctx.beginPath(); ctx.arc(-38, 0, 12, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc( 38, 0, 12, 0, Math.PI*2); ctx.fill();

    // Driver (Newton Bill)
    ctx.fillStyle = '#FFDBA4';
    ctx.beginPath(); ctx.arc(0, -52, 12, 0, Math.PI*2); ctx.fill(); // head
    ctx.fillStyle = '#F44336';
    ctx.fillRect(-14, -44, 28, 20); // red helmet

    ctx.restore();

    // Exhaust smoke when accelerating
    if(keys.gas && fuel > 0){
        ctx.fillStyle = 'rgba(100,100,100,0.3)';
        let smokeX = car.x - cameraX - 60 * Math.cos(car.angle);
        let smokeY = car.y - 60 * Math.sin(car.angle);
        ctx.beginPath();
        ctx.arc(smokeX + Math.random()*20, smokeY + Math.random()*20, 15, 0, Math.PI*2);
        ctx.fill();
    }
}

function gameOver(){
    document.getElementById('gameOver').style.display = 'block';
    document.getElementById('finalDist').textContent = distance + ' meters';
    document.getElementById('finalCoins').textContent = coins + ' coins';
}

function restartGame(){
    car.x = 300; car.y = 300; car.vx = 0; car.vy = 0; car.angle = 0;
    cameraX = 0; distance = 0; fuel = 200; coins = 0;
    terrain.length = 0; coinList.length = 0; generatedX = 0;
    document.getElementById('gameOver').style.display = 'none';
}

document.getElementById('restart').onclick = restartGame;

// ================ GAME LOOP ================
function loop(){
    generateTerrain();
    updateCar();
    draw();
    requestAnimationFrame(loop);
}

// Start
generateTerrain();
loop();
</script>
</body>
</html>
